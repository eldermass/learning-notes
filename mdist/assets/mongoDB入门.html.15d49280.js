import{_ as n,o as s,c as a,d as t}from"./app.4b7e0070.js";const p={},e=t(`<h1 id="mongodb-\u5165\u95E8" tabindex="-1"><a class="header-anchor" href="#mongodb-\u5165\u95E8" aria-hidden="true">#</a> MongoDb \u5165\u95E8</h1><h2 id="\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u76F4\u63A5\u542F\u52A8</span>
mongod --dbpath <span class="token punctuation">..</span>/data/db
<span class="token comment"># \u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u7684\u65B9\u5F0F\u542F\u52A8\u670D\u52A1</span>
mongod -f <span class="token punctuation">..</span>/etc/mongo.conf  
        --smallfiles <span class="token comment"># \u7A7A\u95F4\u4E0D\u591F\u65F6\u53EF\u7528</span>
    <span class="token comment"># 1.\u7F16\u5199\u914D\u7F6E\u6587\u4EF6 \u4E00\u822C\u653E\u5728\u6839\u76EE\u5F55 etc/mongodb.conf</span>
        <span class="token assign-left variable">logpath</span><span class="token operator">=</span><span class="token punctuation">..</span>/log/mongodb.log      <span class="token comment"># log\u5730\u5740</span>
        <span class="token assign-left variable">logappend</span><span class="token operator">=</span>false                 <span class="token comment"># log\u662F\u5426\u8FFD\u52A0\u5230\u4E4B\u524D\u7684\u6587\u4EF6</span>
        <span class="token assign-left variable">dbpath</span><span class="token operator">=</span><span class="token punctuation">..</span>/data/db               <span class="token comment"># \u6570\u636E\u5B58\u653E\u4F4D\u7F6E</span>
        <span class="token assign-left variable">fork</span><span class="token operator">=</span>false                      <span class="token comment"># \u8FDB\u7A0B\u662F\u5426\u4FDD\u7559\u5728\u540E\u53F0</span>
        port <span class="token operator">=</span> <span class="token number">27017</span>
    <span class="token comment"># 2.\u914D\u7F6E\u5B8C\u6210\u540E\uFF0C\u6267\u884C\u4EE5\u4E0B\u547D\u4EE4 \u5B89\u88C5\u5230\u670D\u52A1</span>
        mongod --config <span class="token string">&quot;F:\\mongoDB\\mongodb/etc/mongo.conf&quot;</span> --install
        <span class="token comment"># \u6216\u8005 \u76F4\u63A5\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4</span>
        mongod --bind_ip <span class="token number">127.0</span>.0.1 --logpath F:<span class="token punctuation">\\</span>mongoDB<span class="token punctuation">\\</span>mongodb<span class="token punctuation">\\</span>log<span class="token punctuation">\\</span>log.txt --logappend --dbpath <span class="token string">&quot;F:\\mongoDB\\mongodb\\data\\db&quot;</span> --directoryperdb --serviceName MongoDB --install
        <span class="token comment"># \u5220\u9664</span>
        mongod --remove
    <span class="token comment"># 3.\u914D\u7F6E\u73AF\u5883\u53D8\u91CF</span>

<span class="token comment"># \u5B89\u88C5\u597D\u670D\u52A1\u540E\uFF0C\u5982\u679C\u670D\u52A1\u662F\u624B\u52A8\u542F\u52A8\uFF0Cnet start MongoDB, \u8FD9\u6837\u5C31\u5F00\u542F\u4E86\u540E\u53F0\u670D\u52A1\u4E86</span>

<span class="token comment"># mongo.conf\u6587\u4EF6\u793A\u4F8B  \u7EDD\u5BF9\u8DEF\u5F84</span>
systemLog:
    destination: <span class="token function">file</span>
    path: F:<span class="token punctuation">\\</span>mongoDB<span class="token punctuation">\\</span>mongodb<span class="token punctuation">\\</span>log<span class="token punctuation">\\</span>log.txt
    logAppend: <span class="token boolean">true</span>
storage:
    journal:
        enabled: <span class="token boolean">true</span>
    dbPath: F:<span class="token punctuation">\\</span>mongoDB<span class="token punctuation">\\</span>mongodb<span class="token punctuation">\\</span>data<span class="token punctuation">\\</span>db<span class="token punctuation">\\</span>
net: 
    port: <span class="token number">27017</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528" aria-hidden="true">#</a> \u4F7F\u7528</h2><h3 id="\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u6307\u4EE4" aria-hidden="true">#</a> \u6307\u4EE4</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. \u9AD8\u7EA7\u6307\u4EE4</span>
    db.test.drop<span class="token punctuation">(</span><span class="token punctuation">)</span>  \u9AD8\u7EA7\u547D\u4EE4  \u7B49\u540C\u4E8E
<span class="token comment"># 2. \u57FA\u7840\u6307\u4EE4\uFF0C\u4F8B\u5982</span>
    db.runCommand<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;drop&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;test&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># {\u6307\u4EE4\uFF1A \u76EE\u6807} \u4F1A\u8FD4\u56DE\u4E00\u4E2A\u66F4\u4E3A\u8BE6\u7EC6\u7684\u6587\u6863</span>
<span class="token comment"># 3. \u5E95\u5C42\u6307\u4EE4</span>
    db.<span class="token variable">$cmd</span>.findOne<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;drop&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;test&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment"># \u542F\u52A8</span>
db.runCommand<span class="token punctuation">(</span><span class="token punctuation">{</span>getLastError: <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># \u4E0D\u5E26 port \u4E3A\u9ED8\u8BA4\uFF0C --host \u94FE\u63A5\u5176\u4ED6\u4E3B\u673A</span>
mongo --port <span class="token number">27017</span>
<span class="token comment"># \u67E5\u770B\u7528\u6237\u5217\u8868</span>
show <span class="token function">users</span>

<span class="token comment"># \u5E93</span>
show dbs <span class="token comment"># \u67E5\u770B\u5E93 </span>
use <span class="token builtin class-name">test</span> <span class="token comment"># \u5207\u6362/\u521B\u5EFA\u5E93\uFF0C\u5982\u679C\u6CA1\u6709\u4F1A\u5EF6\u65F6\u521B\u5EFA</span>
db.dropDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u5220\u9664\u5E93</span>

<span class="token comment"># \u96C6\u5408</span>
show collections <span class="token comment"># \u67E5\u770B\u96C6\u5408(\u7C7B\u4F3C\u8868) </span>
db.acount.save<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Jack&#39;</span>, <span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># \u521B\u5EFA\u96C6\u5408db.\u5E93\u540D.save({})</span>
db.acount.find<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u67E5\u8BE2acount\u96C6\u5408</span>
db.acount.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;name&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Jack&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># \u67E5\u8BE2acount\u96C6\u5408</span>
db.acount.drop<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># \u5220\u9664acount\u96C6\u5408</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6062\u590D\u5907\u4EFD" tabindex="-1"><a class="header-anchor" href="#\u6062\u590D\u5907\u4EFD" aria-hidden="true">#</a> \u6062\u590D\u5907\u4EFD</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5907\u4EFD</span>
<span class="token comment"># \u5730\u5740\uFF0C \u6570\u636E\u5E93\u540D\uFF0C \u76EE\u5F55\u8DEF\u5F84</span>
mongodump -h dbhost -d dbname -o dbdirectory

<span class="token comment"># \u6062\u590D</span>
mongorestore -h dbhost -d dbname --directoryperdb dbdirectory
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u5BFC\u5165\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#\u5BFC\u5165\u5BFC\u51FA" aria-hidden="true">#</a> \u5BFC\u5165\u5BFC\u51FA</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5BFC\u51FA</span>
mongoexport -d dbname -c collectionname -q <span class="token punctuation">{</span>\u67E5\u8BE2\u6761\u4EF6<span class="token punctuation">}</span> -f name,age<span class="token operator">&gt;</span>path
mongoexport -d <span class="token builtin class-name">test</span> -c boss -o D:/boss.json --type<span class="token operator">=</span>json
    <span class="token comment"># csv\u5BFC\u51FA</span>
mongoexport -d dbname -c collectionname -q <span class="token punctuation">{</span>\u67E5\u8BE2\u6761\u4EF6<span class="token punctuation">}</span> -f name,age --csv<span class="token operator">&gt;</span>path
mongoexport -d <span class="token builtin class-name">test</span> -c boss -o D:/boss.csv -f name,age --type<span class="token operator">=</span>csv
<span class="token comment">#  \u5BFC\u5165</span>
mongoimport -d dbname -c collectionname --type csv --headerline --drop <span class="token operator">&lt;</span>path
mongoimport --db dbname --collection collectionname --file F:<span class="token punctuation">\\</span>users.json --type<span class="token operator">=</span>json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u589E\u5220\u67E5\u6539" tabindex="-1"><a class="header-anchor" href="#\u589E\u5220\u67E5\u6539" aria-hidden="true">#</a> \u589E\u5220\u67E5\u6539</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 1. \u589E</span>
    db.test.insert<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> \u63D2\u5165 \u4E0D\u80FD\u8D85\u8FC74m  
    db.test.insert<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span> \u591A\u4E2A\u63D2\u5165
    db.test.save<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># 2. \u5220</span>
    db.test.remove<span class="token punctuation">(</span><span class="token punctuation">)</span> \u5220\u9664\u6240\u6709\u6570\u636E
    db.test.remove<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span><span class="token punctuation">)</span> 
    db.test.drop<span class="token punctuation">(</span><span class="token punctuation">)</span>   \u5220\u9664\u6240\u6709\u6570\u636E \u548C \u7D22\u5F15
<span class="token comment"># 3. \u67E5</span>
    db.test.count<span class="token punctuation">(</span><span class="token punctuation">)</span>  \u8BA1\u6570
    db.test.find<span class="token punctuation">(</span><span class="token punctuation">)</span>   \u627E\u67E5
    db.test.find<span class="token punctuation">(</span>query, field, limit, skip, batchSize, options<span class="token punctuation">)</span>   \u627E\u67E5\u7684\u53C2\u6570
    db.test.find<span class="token punctuation">(</span><span class="token punctuation">{</span>name: <span class="token string">&#39;huang&#39;</span>, age: <span class="token punctuation">{</span><span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;_id&#39;</span><span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span> \u591A\u6761\u4EF6\u627E\u67E5, \u4E0D\u8FD4\u56DEid
    \u6BD4\u8F83\u64CD\u4F5C\u7B26  <span class="token variable">$lt</span> <span class="token variable">$lte</span> <span class="token variable">$gt</span> <span class="token variable">$gte</span> <span class="token variable">$ne</span> \u5BF9\u5E94 <span class="token operator">&lt;</span> <span class="token operator">&lt;=</span> <span class="token operator">&gt;</span> <span class="token operator">&gt;=</span> <span class="token operator">!=</span> 
                <span class="token variable">$in</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">1</span>, <span class="token number">5</span><span class="token punctuation">]</span> \u5728\u6570\u7EC4\u4E2D\u7684 <span class="token variable">$nin</span> \u4E0D\u5728\u5176\u4E2D
                <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\u6761\u4EF61<span class="token punctuation">}</span>, <span class="token punctuation">{</span>\u6761\u4EF62<span class="token punctuation">}</span><span class="token punctuation">]</span>
                <span class="token variable">$not</span><span class="token builtin class-name">:</span> \u53D6\u975E
                <span class="token variable">$mod</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token number">5</span>, <span class="token number">0</span><span class="token punctuation">]</span> \u53D6\u6A21 %5\u4E3A0\u7684
    \xB7 \u9AD8\u7EA7\u67E5\u8BE2\u89C4\u5219
        null \u5339\u914D\u81EA\u8EAB\u548C\u4E0D\u5B58\u5728\u3002 alias: null, \u5339\u914D\u6CA1\u6709\u522B\u540D\u6216\u8005\u522B\u540D\u4E3Anull\u7684
        <span class="token variable">$exist</span> \u662F\u5426\u5B58\u5728\u8BE5\u952E     alias: <span class="token boolean">true</span>  \u5339\u914D\u5B58\u5728\u522B\u540D\u7684
        /.+/i \u6B63\u5219\u8868\u8FBE\u5F0F js\u89C4\u5219  
        \u6570\u7EC4:   
            fruit: <span class="token string">&#39;apple&#39;</span>    \u5355\u5143\u7D20\u5339\u914D
            fruit.2: <span class="token string">&#39;apple&#39;</span>    \u4E0B\u6807\u5355\u5143\u7D20\u5339\u914D
            fruit: <span class="token punctuation">{</span><span class="token variable">$size</span><span class="token builtin class-name">:</span> <span class="token number">3</span><span class="token punctuation">}</span>   \u957F\u5EA6\u5339\u914D
            fruit: <span class="token punctuation">{</span><span class="token variable">$all</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&#39;apple&#39;</span>, <span class="token string">&#39;banana&#39;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>   \u591A\u5143\u7D20\u5339\u914D
        \u5185\u5D4C\u6587\u6863<span class="token punctuation">(</span>\u5B50\u5BF9\u8C61<span class="token punctuation">)</span>
            userName: <span class="token punctuation">{</span><span class="token string">&#39;first&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;wang&#39;</span>, <span class="token string">&#39;last&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;jing&#39;</span><span class="token punctuation">}</span>  \u5B8C\u5168\u5339\u914D
            userName.first: <span class="token string">&#39;wang&#39;</span>, userName.last: <span class="token string">&#39;jing&#39;</span> \u5C5E\u6027\u5339\u914D
            <span class="token comment">#elemMatch  \u5185\u5D4C\u6587\u6863\uFF0C\u591A\u6761\u4EF6\u5339\u914D</span>
    \xB7 where\u67E5\u8BE2  js\u5BF9\u8C61\u51FD\u6570\u67E5\u8BE2 \u6027\u80FD\u4F4E
        \u7528\u51FD\u6570\u5FAA\u73AF\u904D\u5386\u6587\u6863\uFF0C
        db.fruit.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$where</span><span class="token builtin class-name">:</span> <span class="token function-name function">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>for<span class="token punctuation">(</span>let key <span class="token keyword">in</span> this<span class="token punctuation">)</span><span class="token punctuation">{</span>if<span class="token punctuation">(</span>key <span class="token operator">==</span><span class="token string">&#39;apple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>return true<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    \xB7 \u67E5\u8BE2\u6E38\u6807
        <span class="token number">1</span>. <span class="token builtin class-name">let</span> cursor <span class="token operator">=</span> db.number.find<span class="token punctuation">(</span><span class="token punctuation">)</span> \u5B9A\u4E49\u6E38\u6807
        <span class="token number">2</span>. cursor.next<span class="token punctuation">(</span><span class="token punctuation">)</span>  \u67E5\u8BE2\u4E0B\u4E00\u4E2A\u503C
            while<span class="token punctuation">(</span>cursor.hasNext<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">{</span> cursor.next<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>  \u67E5\u8BE2\u6700\u540E\u4E00\u4E2A
        \u6E38\u6807\u64CD\u4F5C
        db.number.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        db.number.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.skip<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  \u8DF3\u8FC75\u4E2A\u5339\u914D\u7684\u503C, \u7528\u4E8E\u5206\u9875
        db.number.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.sort<span class="token punctuation">(</span><span class="token punctuation">{</span>x: <span class="token number">1</span>, y: -1<span class="token punctuation">}</span><span class="token punctuation">)</span>\uFF0C <span class="token number">1</span> \u5347\u5E8F\uFF0C -1 \u964D\u5E8F

<span class="token comment"># 4. \u6539 ({\u67E5\u8BE2\u6761\u4EF6}, {\u66F4\u65B0\u7684\u503C}, \u662F\u5426\u5728\u6CA1\u627E\u5230old\u63D2\u5165\u65B0\u7684, \u662F\u5426\u591A\u6587\u6863\u66F4\u65B0)</span>
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>old<span class="token punctuation">}</span>,<span class="token punctuation">{</span>new<span class="token punctuation">}</span><span class="token punctuation">)</span> \u5168\u91CF\u66F4\u65B0
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$set&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;password&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;ddd&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  \u5C40\u90E8\u66F4\u65B0
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$unset&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&#39;age&#39;</span><span class="token builtin class-name">:</span> <span class="token number">23</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>        \u53BB\u9664\u4E00\u4E2A \u952E\u503C
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$inc&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>age: <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>             age \u52A0\u4E00
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$push&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>title: <span class="token string">&#39;nameList&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> \u7ED9title\u6570\u7EC4push\u4E00\u4E2A\u503C
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$addToSet&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>title: <span class="token string">&#39;nameList&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> \u907F\u514D\u91CD\u590D\u7684push\u6DFB\u52A0
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$pop&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>title: <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span> \u7ED9title\u6570\u7EC4pop\u4E00\u4E2A\u503C \uFF0C <span class="token number">1</span>\u5C3E\u90E8\uFF0C -1\u5934\u90E8 \u5220\u9664
    db.test.update<span class="token punctuation">(</span><span class="token punctuation">{</span>\u6761\u4EF6<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token string">&#39;$pull&#39;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>title: \u2018nameList<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  \u5220\u9664\u6570\u7EC4\u4E2D\u7684 \u6307\u5B9A\u4F4D\u7F6E
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="\u7D22\u5F15\u7EDF\u8BA1" tabindex="-1"><a class="header-anchor" href="#\u7D22\u5F15\u7EDF\u8BA1" aria-hidden="true">#</a> \u7D22\u5F15\u7EDF\u8BA1</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u4E00.\u521B\u5EFA\u7D22\u5F15</span>
    <span class="token comment"># \u5355\u4EF6\u7D22\u5F15\uFF0C</span>
        db.test.ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>userid: <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># \u5347\u5E8F</span>
    <span class="token comment"># \u590D\u5408\u7D22\u5F15</span>
        db.test.ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>userid: <span class="token number">1</span>, age: -1<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># \u552F\u4E00\u7D22\u5F15  // \u590D\u5408\u552F\u4E00\u7D22\u5F15\uFF0C\u7684\u7EC4\u5408\u4E0D\u540C\u5373\u53EF</span>
        db.test.ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>userid: <span class="token number">1</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span>unique: true<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># \u4E8C.\u67E5\u8BE2\u5206\u6790</span>
    <span class="token comment"># explain \u7528\u4E8E\u67E5\u8BE2\u6027\u80FD\u5206\u6790</span>
        db.test.find<span class="token punctuation">(</span><span class="token punctuation">{</span>username: <span class="token string">&#39;wang&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.explain<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># hint \u5F3A\u5236\u6307\u5B9A\u67E5\u8BE2\u4F7F\u7528\u7D22\u5F15</span>
        db.test.find<span class="token punctuation">(</span>age: <span class="token punctuation">{</span><span class="token variable">$lt</span> <span class="token builtin class-name">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.hint<span class="token punctuation">(</span><span class="token punctuation">{</span>userName: <span class="token number">1</span>, age: <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># \u4E09. \u7D22\u5F15\u7BA1\u7406</span>
    <span class="token comment"># 1. \u67E5\u770B\u7D22\u5F15</span>
        db.test.getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 2. \u5220\u9664\u7D22\u5F15</span>
        db.test.dropIndex<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u53EF\u4F20\u5165string</span>
        db.test.dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># \u5220\u9664\u5168\u90E8</span>

        db.runCommand<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;dropIndexes&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;test&#39;</span>, <span class="token string">&#39;index&#39;</span><span class="token builtin class-name">:</span> <span class="token string">&#39;x_1&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># 3. \u91CD\u5EFA\u7D22\u5F15</span>
        db.test.reIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># \u56DB. \u805A\u5408\u7EDF\u8BA1</span>
    <span class="token comment"># 1. \u7EDF\u8BA1 count</span>
        db.test.count<span class="token punctuation">(</span><span class="token punctuation">)</span>
        db.test.count<span class="token punctuation">(</span><span class="token punctuation">{</span>age: <span class="token punctuation">{</span><span class="token variable">$lt</span><span class="token builtin class-name">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># 2. \u805A\u5408</span>
        db.test.distinct<span class="token punctuation">(</span>string, <span class="token punctuation">{</span>queryObj<span class="token punctuation">}</span><span class="token punctuation">)</span>
        db.runCommand<span class="token punctuation">(</span><span class="token punctuation">{</span>distinct: <span class="token string">&#39;test&#39;</span>, key: <span class="token string">&#39;value&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment"># 3. \u5206\u7EC4</span>
        db.test.group<span class="token punctuation">(</span><span class="token punctuation">{</span>key: <span class="token punctuation">{</span><span class="token string">&#39;x&#39;</span><span class="token builtin class-name">:</span> true<span class="token punctuation">}</span>,            <span class="token comment"># \u5206\u7EC4\u76EE\u6807</span>
            initial: <span class="token punctuation">{</span>number: <span class="token number">0</span><span class="token punctuation">}</span>,                   <span class="token comment"># \u521D\u59CB\u503C</span>
            reduce: <span class="token punctuation">(</span>doc, prev<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>prev.number++<span class="token punctuation">}</span>, <span class="token comment"># \u8FED\u4EE3\u51FD\u6570</span>
            cond: <span class="token punctuation">{</span>x: <span class="token punctuation">{</span><span class="token variable">$gt</span><span class="token builtin class-name">:</span> <span class="token number">90</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>                  <span class="token comment"># \u67E5\u8BE2\u6761\u4EF6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,14),c=[e];function o(i,l){return s(),a("div",null,c)}var d=n(p,[["render",o],["__file","mongoDB\u5165\u95E8.html.vue"]]);export{d as default};
